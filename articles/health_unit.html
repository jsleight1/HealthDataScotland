<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to health units • HealthDataScotland</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="health_unit_files/libs/quarto-html/popper.min.js"></script><script src="health_unit_files/libs/quarto-html/tippy.umd.min.js"></script><link href="health_unit_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="health_unit_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="health_unit_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="health_unit_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="health_unit_files/libs/echarts4r-4.8.0/echarts-en.min.js"></script><script src="health_unit_files/libs/echarts4r-4.8.0/ecStat.min.js"></script><script src="health_unit_files/libs/echarts4r-4.8.0/dataTool.min.js"></script><script src="health_unit_files/libs/echarts4r-binding-0.4.5/echarts4r.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to health units">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HealthDataScotland</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/HealthDataScotland.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_workflow.html">Data workflow</a></li>
    <li><a class="dropdown-item" href="../articles/health_unit.html">Introduction to health units</a></li>
    <li><a class="dropdown-item" href="../articles/map.html">Introduction to map units</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to health units</h1>





      <div class="d-none name"><code></code></div>
    </div>






    <div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jsleight1.github.io/HealthDataScotland/">HealthDataScotland</a></span><span class="op">)</span></span></code></pre></div>
</div>
<section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>HealthDataScotland uses a series of R6 objects to store and present statistics associated with GP practices and hospitals across Scotland. This vignette will outline the functionality of these objects and the motivation behind their design.</p>
</section><section class="section level2"><h2 id="health-units">Health units<a class="anchor" aria-label="anchor" href="#health-units"></a>
</h2>
<p>The object that acts as the lowest common denominator in HealthDataScotland is a <code>health_unit</code>. These objects store relevant statistics associated with a single health centre (GP or hospital). Currently HealthDataScotland has two class of <code><a href="../reference/health_unit.html">health_unit()</a></code> implemented; <code><a href="../reference/gp.html">gp()</a></code> and <code><a href="../reference/hospital.html">hospital()</a></code> storing data associated with a single GP practice or hospital respectively.</p>
<section class="level2"><h3 id="gp">GP<a class="anchor" aria-label="anchor" href="#gp"></a>
</h3>
<p>Data associated with a single GP practice is stored in a <code><a href="../reference/gp.html">gp()</a></code> health unit object. <code><a href="../reference/example_gp_unit.html">example_gp_unit()</a></code> can be used to render an example object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_unit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_gp_unit.html">example_gp_unit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gp_unit</span></span>
<span><span class="co">#&gt; &lt;gp&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unit&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     .metadata: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     address: function () </span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     health_board: function () </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.metadata, .data) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     popup_modal: function (ns) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     telephone: function () </span></span>
<span><span class="co">#&gt;     title: function () </span></span>
<span><span class="co">#&gt;     ui: function (ns) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     population_pyramid: function (...) </span></span>
<span><span class="co">#&gt;     population_pyramid_data: function () </span></span>
<span><span class="co">#&gt;     population_pyramid_info: function () </span></span>
<span><span class="co">#&gt;     population_trend: function (...) </span></span>
<span><span class="co">#&gt;     population_trend_data: function () </span></span>
<span><span class="co">#&gt;     population_trend_info: function () </span></span>
<span><span class="co">#&gt;     population_trend_y_range: function () </span></span>
<span><span class="co">#&gt;     required_data_cols: function () </span></span>
<span><span class="co">#&gt;     required_metadata_cols: function () </span></span>
<span><span class="co">#&gt;     title_col: function ()</span></span></code></pre></div>
</div>
<section class="level3"><h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>GP health unit objects house a data.frame storing demography statistics and a data.frame storing metadata associated with the GP practice. These can be obtained using the public functions <code>$data</code> and <code>$metadata</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9 × 23</span></span>
<span><span class="co">#&gt;     Date ID    HB    Sex   SexQF AllAges AllAgesQF Ages0to4 Ages0To4QF Ages5to14</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2.02e7 10002 S080… Male  &lt;NA&gt;     4056 &lt;NA&gt;           186 &lt;NA&gt;             456</span></span>
<span><span class="co">#&gt; 2 2.02e7 10002 S080… Fema… &lt;NA&gt;     4195 &lt;NA&gt;           176 &lt;NA&gt;             397</span></span>
<span><span class="co">#&gt; 3 2.02e7 10002 S080… All   d        8251 &lt;NA&gt;           362 &lt;NA&gt;             853</span></span>
<span><span class="co">#&gt; 4 2.02e7 10002 S080… Male  &lt;NA&gt;     4065 &lt;NA&gt;           190 &lt;NA&gt;             456</span></span>
<span><span class="co">#&gt; 5 2.02e7 10002 S080… Fema… &lt;NA&gt;     4209 &lt;NA&gt;           171 &lt;NA&gt;             401</span></span>
<span><span class="co">#&gt; 6 2.02e7 10002 S080… All   d        8274 &lt;NA&gt;           361 &lt;NA&gt;             857</span></span>
<span><span class="co">#&gt; 7 2.02e7 10002 S080… Male  &lt;NA&gt;     4085 &lt;NA&gt;           186 &lt;NA&gt;             463</span></span>
<span><span class="co">#&gt; 8 2.02e7 10002 S080… Fema… &lt;NA&gt;     4216 &lt;NA&gt;           170 &lt;NA&gt;             407</span></span>
<span><span class="co">#&gt; 9 2.02e7 10002 S080… All   d        8301 &lt;NA&gt;           356 &lt;NA&gt;             870</span></span>
<span><span class="co">#&gt; # ℹ 13 more variables: Ages5To14QF &lt;chr&gt;, Ages15to24 &lt;dbl&gt;, Ages15To24QF &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   Ages25to44 &lt;dbl&gt;, Ages25To44QF &lt;chr&gt;, Ages45to64 &lt;dbl&gt;, Ages45To64QF &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   Ages65to74 &lt;dbl&gt;, Ages65To74QF &lt;chr&gt;, Ages75to84 &lt;dbl&gt;, Ages75To84QF &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   Ages85plus &lt;dbl&gt;, Ages85PlusQF &lt;chr&gt;</span></span>
<span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">metadata</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 16</span></span>
<span><span class="co">#&gt;   datasetID      ID    GPPracticeName PracticeListSize AddressLine1 AddressLine2</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       </span></span>
<span><span class="co">#&gt; 1 b3b126d3-3b0c… 10002 Muirhead Medi…             8251 Muirhead Me… Liff Road   </span></span>
<span><span class="co">#&gt; # ℹ 10 more variables: AddressLine3 &lt;chr&gt;, AddressLine4 &lt;chr&gt;, Postcode &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   TelephoneNumber &lt;chr&gt;, PracticeType &lt;chr&gt;, Dispensing &lt;lgl&gt;, HBName &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   HSCP &lt;chr&gt;, DataZone &lt;chr&gt;, GPCluster &lt;chr&gt;</span></span></code></pre></div>
</div>
<p>In addition, to the <code>$metadata</code> function returing a data.frame there are also relevant helper functions to pull out particular metadata associated with a GP practice.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">ID</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "10002"</span></span>
<span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">title</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Muirhead Medical Centre"</span></span>
<span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">health_board</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "S08000030"</span></span>
<span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">address</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Muirhead Medical Centre, Liff Road, Muirhead, DD2 5NH"</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h4>
<p>Visualising data associated with a single GP practice can be achieved using the <code>$plot</code> function with an appropriate <code>type</code> argument. To see which plot types are available to use, the <code>$available_plots</code> function can be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">available_plots</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "population_pyramid" "population_trend"</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"population_pyramid"</span><span class="op">)</span></span></code></pre></div>
<div id="fig-gp_population_pyramid" class="cell-output-display quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-gp_population_pyramid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="echarts4r html-widget html-fill-item" id="htmlwidget-7b64371b573eb7a9eab6" style="width:100%;height:500px;"></div>
<script type="application/json" data-for="htmlwidget-7b64371b573eb7a9eab6">{"x":{"theme":"","tl":true,"draw":true,"renderer":"canvas","events":[],"buttons":[],"opts":{"baseOption":{"xAxis":[{"show":true,"axisLabel":{"formatter":"function (value) {\n            return(Math.abs(value))\n          }"}}],"timeline":{"data":["20231001","20240101","20240401"],"axisType":"category","autoPlay":true},"yAxis":[{"data":["Ages0to4","Ages5to14","Ages15to24","Ages25to44","Ages45to64","Ages65to74","Ages75to84","Ages85plus"],"type":"category","boundaryGap":true}],"legend":{"data":["Male","Female"],"show":true,"type":"plain","top":10,"left":"center","data.1":["Female","Male"]},"series":[{"name":"Male","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d","stack":"quantity"},{"name":"Female","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d","stack":"quantity"}],"tooltip":{"trigger":"item","formatter":"\n        function(params){\n          return(\n            '<strong>' + 'Age: ' + '<\/strong>' + params.name + ' years' + '<br />' +\n            '<strong>' + 'Population: ' + '<\/strong>' + Math.abs(params.value[0])\n          )\n        }\n        "}},"options":[{"series":[{"data":[{"value":[" 186","Ages0to4"]},{"value":[" 463","Ages5to14"]},{"value":[" 419","Ages15to24"]},{"value":[" 952","Ages25to44"]},{"value":["1170","Ages45to64"]},{"value":[" 494","Ages65to74"]},{"value":[" 307","Ages75to84"]},{"value":["  94","Ages85plus"]}]},{"data":[{"value":[" -170","Ages0to4"]},{"value":[" -407","Ages5to14"]},{"value":[" -430","Ages15to24"]},{"value":[" -975","Ages25to44"]},{"value":["-1259","Ages45to64"]},{"value":[" -539","Ages65to74"]},{"value":[" -339","Ages75to84"]},{"value":["  -97","Ages85plus"]}]}]},{"series":[{"data":[{"value":[" 190","Ages0to4"]},{"value":[" 456","Ages5to14"]},{"value":[" 419","Ages15to24"]},{"value":[" 946","Ages25to44"]},{"value":["1159","Ages45to64"]},{"value":[" 496","Ages65to74"]},{"value":[" 308","Ages75to84"]},{"value":["  91","Ages85plus"]}]},{"data":[{"value":[" -171","Ages0to4"]},{"value":[" -401","Ages5to14"]},{"value":[" -429","Ages15to24"]},{"value":[" -967","Ages25to44"]},{"value":["-1258","Ages45to64"]},{"value":[" -535","Ages65to74"]},{"value":[" -345","Ages75to84"]},{"value":[" -103","Ages85plus"]}]}]},{"series":[{"data":[{"value":[" 186","Ages0to4"]},{"value":[" 456","Ages5to14"]},{"value":[" 415","Ages15to24"]},{"value":[" 945","Ages25to44"]},{"value":["1160","Ages45to64"]},{"value":[" 494","Ages65to74"]},{"value":[" 312","Ages75to84"]},{"value":["  88","Ages85plus"]}]},{"data":[{"value":[" -176","Ages0to4"]},{"value":[" -397","Ages5to14"]},{"value":[" -425","Ages15to24"]},{"value":[" -961","Ages25to44"]},{"value":["-1256","Ages45to64"]},{"value":[" -535","Ages65to74"]},{"value":[" -344","Ages75to84"]},{"value":[" -101","Ages85plus"]}]}]}],"legend":{"data":[null,null,null,null,null,null]}},"dispose":true},"evals":["opts.baseOption.xAxis.0.axisLabel.formatter","opts.baseOption.tooltip.formatter"],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gp_population_pyramid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 1: This bar chart shows a population pyramid of the total number of GP registered patients (x-axis) across age category (y-axis) for each gender (colour).
</figcaption></figure>
</div>
</div>
<p>Helper functions <code>$plot_data</code> and <code>$plot_info</code> can be used to create the data associated with each plot and character text describing each plot (alongside functionality related to the shiny application) respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">plot_data</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"population_pyramid"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 24 × 4</span></span>
<span><span class="co">#&gt; # Groups:   Date [3]</span></span>
<span><span class="co">#&gt;        Date Age        Female  Male</span></span>
<span><span class="co">#&gt;       &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 20231001 Ages0to4     -170   186</span></span>
<span><span class="co">#&gt;  2 20231001 Ages5to14    -407   463</span></span>
<span><span class="co">#&gt;  3 20231001 Ages15to24   -430   419</span></span>
<span><span class="co">#&gt;  4 20231001 Ages25to44   -975   952</span></span>
<span><span class="co">#&gt;  5 20231001 Ages45to64  -1259  1170</span></span>
<span><span class="co">#&gt;  6 20231001 Ages65to74   -539   494</span></span>
<span><span class="co">#&gt;  7 20231001 Ages75to84   -339   307</span></span>
<span><span class="co">#&gt;  8 20231001 Ages85plus    -97    94</span></span>
<span><span class="co">#&gt;  9 20240101 Ages0to4     -171   190</span></span>
<span><span class="co">#&gt; 10 20240101 Ages5to14    -401   456</span></span>
<span><span class="co">#&gt; # ℹ 14 more rows</span></span>
<span><span class="va">gp_unit</span><span class="op">$</span><span class="fu">plot_info</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"population_pyramid"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "This bar chart shows a population pyramid of the total number of\n            GP registered patients (x-axis) across age category\n            (y-axis) for each gender (colour)."</span></span></code></pre></div>
</div>
</section></section><section class="level2"><h3 id="hospital">Hospital<a class="anchor" aria-label="anchor" href="#hospital"></a>
</h3>
<p>Data associated with a single hospital is stored in a <code><a href="../reference/hospital.html">hospital()</a></code> health unit object. <code><a href="../reference/example_hospital_unit.html">example_hospital_unit()</a></code> can be used to render an example object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_unit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_hospital_unit.html">example_hospital_unit</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<section class="level3"><h4 id="data-1">Data<a class="anchor" aria-label="anchor" href="#data-1"></a>
</h4>
<p>Hospital health unit objects house a data.frame storing bed capacity data and a data.frame storing metadata associated with the hospital. These can be obtained using the public functions <code>$data</code> and <code>$metadata</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 21 × 23</span></span>
<span><span class="co">#&gt;    datasetID          FinancialYear FinancialYearQF HB    HBQF  ID    LocationQF</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;              &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     </span></span>
<span><span class="co">#&gt;  1 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt;  2 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt;  3 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt;  4 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt;  5 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt;  6 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt;  7 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt;  8 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt;  9 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt; 10 d719af13-5fb3-430… 2022/23       &lt;NA&gt;            S080… &lt;NA&gt;  A101H &lt;NA&gt;      </span></span>
<span><span class="co">#&gt; # ℹ 11 more rows</span></span>
<span><span class="co">#&gt; # ℹ 16 more variables: Specialty &lt;chr&gt;, SpecialtyQF &lt;chr&gt;, SpecialtyName &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   SpecialtyNameQF &lt;chr&gt;, SpecialtyGrouping &lt;chr&gt;, SpecialtyGroupingQF &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   AverageAvailableStaffedBeds &lt;dbl&gt;, AverageAvailableStaffedBedsQF &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   PercentageOccupancy &lt;dbl&gt;, PercentageOccupancyQF &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   AllStaffedBeds &lt;dbl&gt;, AllStaffedBedsQF &lt;chr&gt;, AverageOccupiedBeds &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   AverageOccupiedBedsQF &lt;chr&gt;, TotalOccupiedBeds &lt;dbl&gt;, …</span></span>
<span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">metadata</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 16</span></span>
<span><span class="co">#&gt;   datasetID          ID    HospitalName AddressLine1 AddressLine2 AddressLine2QF</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;         </span></span>
<span><span class="co">#&gt; 1 c698f450-eeed-41a… A101H Arran War M… Lamlash      Isle of Arr… &lt;NA&gt;          </span></span>
<span><span class="co">#&gt; # ℹ 10 more variables: AddressLine3 &lt;chr&gt;, AddressLine3QF &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   AddressLine4 &lt;chr&gt;, AddressLine4QF &lt;chr&gt;, Postcode &lt;chr&gt;, HBName &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   HSCP &lt;chr&gt;, CouncilArea &lt;chr&gt;, IntermediateZone &lt;chr&gt;, DataZone &lt;chr&gt;</span></span></code></pre></div>
</div>
<p>In addition, to the <code>$metadata</code> function returing a data.frame there are also relevant helper functions to pull out particular metadata associated with a hospital.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">ID</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A101H"</span></span>
<span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">title</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Arran War Memorial Hospital"</span></span>
<span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">health_board</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "S08000015"</span></span>
<span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">address</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Lamlash, Isle of Arran, KA278LF"</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="plotting-1">Plotting<a class="anchor" aria-label="anchor" href="#plotting-1"></a>
</h4>
<p>Visualising data associated with a single hospital can be achieved using the <code>$plot</code> function with an appropriate <code>type</code> argument. To see which plot types are available to use, the <code>$available_plots</code> function can be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">available_plots</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "specialty_line"</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"specialty_line"</span><span class="op">)</span></span></code></pre></div>
<div id="fig-hosp_specialty_line_annual" class="cell-output-display quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-hosp_specialty_line_annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="row">
<div class="col-xs-12">
<div class="echarts4r html-widget html-fill-item" id="htmlwidget-24dd4346c4d4539cf54c" style="width:100%;height:500px;"></div>
<script type="application/json" data-for="htmlwidget-24dd4346c4d4539cf54c">{"x":{"theme":"","tl":false,"draw":true,"renderer":"canvas","events":[],"buttons":[],"opts":{"yAxis":[{"show":true,"name":"value"}],"xAxis":[{"data":["2022/23","2023/24"],"type":"category","boundaryGap":true,"name":"FinancialYear"}],"legend":{"data":["Annual number of available staffed beds","Annual number of occupied beds"]},"series":[{"data":[{"value":["2022/23","3263"]},{"value":["2023/24","3631"]}],"yAxisIndex":0,"xAxisIndex":0,"name":"Annual number of available staffed beds","type":"line","coordinateSystem":"cartesian2d"},{"data":[{"value":["2022/23","2526"]},{"value":["2023/24","2488"]}],"yAxisIndex":0,"xAxisIndex":0,"name":"Annual number of occupied beds","type":"line","coordinateSystem":"cartesian2d"}],"tooltip":{"trigger":"axis"},"title":[{"subtext":"All Specialties"}]},"dispose":true},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hosp_specialty_line_annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 2: This line chart shows the annual number of available staffed beds and the number occupied (y-axis) across time (x-axis). Settings can be used to show data for different specialties (default is all specialities).
</figcaption></figure>
</div>
</div>
<p>Helper functions <code>$plot_data</code> and <code>$plot_info</code> can be used to create the data associated with each plot and character text describing each plot (alongside functionality related to the shiny application) respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">plot_data</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"specialty_line"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 7</span></span>
<span><span class="co">#&gt;   ID    FinancialYear HospitalName SpecialtyName PercentageOccupancy name  value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;                       &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A101H 2022/23       Arran War M… All Specialt…                77.4 Annu…  3263</span></span>
<span><span class="co">#&gt; 2 A101H 2022/23       Arran War M… All Specialt…                77.4 Annu…  2526</span></span>
<span><span class="co">#&gt; 3 A101H 2023/24       Arran War M… All Specialt…                68.5 Annu…  3631</span></span>
<span><span class="co">#&gt; 4 A101H 2023/24       Arran War M… All Specialt…                68.5 Annu…  2488</span></span>
<span><span class="va">hospital_unit</span><span class="op">$</span><span class="fu">plot_info</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"specialty_line"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "This line chart shows the annual number of\n                    available staffed beds and the number occupied (y-axis)\n                    across time (x-axis). Settings can be used to show data for\n                    different specialties (default is all specialities)."</span></span></code></pre></div>
</div>
</section></section></section><section class="section level2"><h2 id="health-unit-grps">Health unit grps<a class="anchor" aria-label="anchor" href="#health-unit-grps"></a>
</h2>
<p>HealthDataScotland contains functionality that combines several GP practices or hospitals to create summary visualisations. This is achieved by using <code><a href="../reference/health_unitgrp.html">health_unitgrp()</a></code> objects, which house multiple health units. Currently HealthDataScotland has two class of <code><a href="../reference/health_unitgrp.html">health_unitgrp()</a></code> implemented; <code><a href="../reference/gp_grp.html">gp_grp()</a></code> and <code><a href="../reference/hospital_grp.html">hospital_grp()</a></code>, which store data associated with a multiple GP practices or hospitals respectively.</p>
<section class="level2"><h3 id="gp-1">GP<a class="anchor" aria-label="anchor" href="#gp-1"></a>
</h3>
<p>Data associated with multiple GP practices is stored in <code><a href="../reference/gp_grp.html">gp_grp()</a></code> objects. <code><a href="../reference/example_gp_grp_unit.html">example_gp_grp_unit()</a></code> can be used to render an example object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_grp_unit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_gp_grp_unit.html">example_gp_grp_unit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gp_grp_unit</span></span>
<span><span class="co">#&gt; &lt;gp_grp&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unitgrp&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: list</span></span>
<span><span class="co">#&gt;     .id: gp</span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     download_handler: function () </span></span>
<span><span class="co">#&gt;     health_unit: function (id) </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     IDs: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.data, .id) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     subset: function (id) </span></span>
<span><span class="co">#&gt;     titles: function () </span></span>
<span><span class="co">#&gt;     ui: function (...) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     bar_data: function (x, col, ...) </span></span>
<span><span class="co">#&gt;     bar_echart: function (x) </span></span>
<span><span class="co">#&gt;     gender_choices: function () </span></span>
<span><span class="co">#&gt;     gp_bar: function (...) </span></span>
<span><span class="co">#&gt;     gp_bar_data: function (gp = private[["unit_choices"]](), gender = private[["gender_choices"]]()) </span></span>
<span><span class="co">#&gt;     gp_bar_info: function () </span></span>
<span><span class="co">#&gt;     gp_data: function (gp, gender) </span></span>
<span><span class="co">#&gt;     gp_trend: function (...) </span></span>
<span><span class="co">#&gt;     gp_trend_data: function (gp = private[["unit_choices"]](), gender = private[["gender_choices"]]()) </span></span>
<span><span class="co">#&gt;     gp_trend_info: function () </span></span>
<span><span class="co">#&gt;     health_board_bar: function (...) </span></span>
<span><span class="co">#&gt;     health_board_bar_data: function (health_board = private[["health_board_choices"]](), </span></span>
<span><span class="co">#&gt;     health_board_bar_info: function () </span></span>
<span><span class="co">#&gt;     health_board_choices: function () </span></span>
<span><span class="co">#&gt;     health_board_data: function (health_board, gender) </span></span>
<span><span class="co">#&gt;     health_board_trend: function (...) </span></span>
<span><span class="co">#&gt;     health_board_trend_data: function (health_board = private[["health_board_choices"]](), </span></span>
<span><span class="co">#&gt;     health_board_trend_info: function () </span></span>
<span><span class="co">#&gt;     id_name_labels: function (x, name) </span></span>
<span><span class="co">#&gt;     id_name_selection: function () </span></span>
<span><span class="co">#&gt;     map_combine: function (func, nms = self[["IDs"]](), id = "ID", ...) </span></span>
<span><span class="co">#&gt;     national_pyramid: function () </span></span>
<span><span class="co">#&gt;     national_pyramid_data: function () </span></span>
<span><span class="co">#&gt;     national_pyramid_info: function () </span></span>
<span><span class="co">#&gt;     national_trend: function (...) </span></span>
<span><span class="co">#&gt;     national_trend_data: function () </span></span>
<span><span class="co">#&gt;     national_trend_info: function () </span></span>
<span><span class="co">#&gt;     trend_data: function (x, ...) </span></span>
<span><span class="co">#&gt;     trend_echart: function (x) </span></span>
<span><span class="co">#&gt;     unit_choices: function ()</span></span></code></pre></div>
</div>
<section class="level3"><h4 id="data-2">Data<a class="anchor" aria-label="anchor" href="#data-2"></a>
</h4>
<p><code><a href="../reference/gp_grp.html">gp_grp()</a></code> objects contain a list of <code><a href="../reference/gp.html">gp()</a></code> health units. These can be accessed using the <code>$data</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; &lt;gp&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unit&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     .metadata: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     address: function () </span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     health_board: function () </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.metadata, .data) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     popup_modal: function (ns) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     telephone: function () </span></span>
<span><span class="co">#&gt;     title: function () </span></span>
<span><span class="co">#&gt;     ui: function (ns) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     population_pyramid: function (...) </span></span>
<span><span class="co">#&gt;     population_pyramid_data: function () </span></span>
<span><span class="co">#&gt;     population_pyramid_info: function () </span></span>
<span><span class="co">#&gt;     population_trend: function (...) </span></span>
<span><span class="co">#&gt;     population_trend_data: function () </span></span>
<span><span class="co">#&gt;     population_trend_info: function () </span></span>
<span><span class="co">#&gt;     population_trend_y_range: function () </span></span>
<span><span class="co">#&gt;     required_data_cols: function () </span></span>
<span><span class="co">#&gt;     required_metadata_cols: function () </span></span>
<span><span class="co">#&gt;     title_col: function () </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; &lt;gp&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unit&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     .metadata: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     address: function () </span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     health_board: function () </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.metadata, .data) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     popup_modal: function (ns) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     telephone: function () </span></span>
<span><span class="co">#&gt;     title: function () </span></span>
<span><span class="co">#&gt;     ui: function (ns) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     population_pyramid: function (...) </span></span>
<span><span class="co">#&gt;     population_pyramid_data: function () </span></span>
<span><span class="co">#&gt;     population_pyramid_info: function () </span></span>
<span><span class="co">#&gt;     population_trend: function (...) </span></span>
<span><span class="co">#&gt;     population_trend_data: function () </span></span>
<span><span class="co">#&gt;     population_trend_info: function () </span></span>
<span><span class="co">#&gt;     population_trend_y_range: function () </span></span>
<span><span class="co">#&gt;     required_data_cols: function () </span></span>
<span><span class="co">#&gt;     required_metadata_cols: function () </span></span>
<span><span class="co">#&gt;     title_col: function ()</span></span></code></pre></div>
</div>
<p>Metadata for all <code><a href="../reference/gp.html">gp()</a></code> health units within the gp_grp object can be summarised using the <code>$metadata</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">metadata</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 16</span></span>
<span><span class="co">#&gt;   datasetID      ID    GPPracticeName PracticeListSize AddressLine1 AddressLine2</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       </span></span>
<span><span class="co">#&gt; 1 b3b126d3-3b0c… 10002 Muirhead Medi…             8251 Muirhead Me… Liff Road   </span></span>
<span><span class="co">#&gt; 2 b3b126d3-3b0c… 10017 The Blue Prac…             7272 The Blue Pr… Crieff Medi…</span></span>
<span><span class="co">#&gt; # ℹ 10 more variables: AddressLine3 &lt;chr&gt;, AddressLine4 &lt;chr&gt;, Postcode &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   TelephoneNumber &lt;chr&gt;, PracticeType &lt;chr&gt;, Dispensing &lt;lgl&gt;, HBName &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   HSCP &lt;chr&gt;, DataZone &lt;chr&gt;, GPCluster &lt;chr&gt;</span></span></code></pre></div>
</div>
<p>Additionally, selected metadata from the <code><a href="../reference/gp.html">gp()</a></code> health units can also be obtained using relevant getter functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">IDs</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "10002" "10017"</span></span>
<span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">titles</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Muirhead Medical Centre" "The Blue Practice"</span></span></code></pre></div>
</div>
<p><code><a href="../reference/gp_grp.html">gp_grp()</a></code> objects can also be subset to the selected GP practices using <code>$subset</code> with a set of character IDs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">subset</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"10017"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;gp_grp&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unitgrp&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: list</span></span>
<span><span class="co">#&gt;     .id: gp</span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     download_handler: function () </span></span>
<span><span class="co">#&gt;     health_unit: function (id) </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     IDs: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.data, .id) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     subset: function (id) </span></span>
<span><span class="co">#&gt;     titles: function () </span></span>
<span><span class="co">#&gt;     ui: function (...) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     bar_data: function (x, col, ...) </span></span>
<span><span class="co">#&gt;     bar_echart: function (x) </span></span>
<span><span class="co">#&gt;     gender_choices: function () </span></span>
<span><span class="co">#&gt;     gp_bar: function (...) </span></span>
<span><span class="co">#&gt;     gp_bar_data: function (gp = private[["unit_choices"]](), gender = private[["gender_choices"]]()) </span></span>
<span><span class="co">#&gt;     gp_bar_info: function () </span></span>
<span><span class="co">#&gt;     gp_data: function (gp, gender) </span></span>
<span><span class="co">#&gt;     gp_trend: function (...) </span></span>
<span><span class="co">#&gt;     gp_trend_data: function (gp = private[["unit_choices"]](), gender = private[["gender_choices"]]()) </span></span>
<span><span class="co">#&gt;     gp_trend_info: function () </span></span>
<span><span class="co">#&gt;     health_board_bar: function (...) </span></span>
<span><span class="co">#&gt;     health_board_bar_data: function (health_board = private[["health_board_choices"]](), </span></span>
<span><span class="co">#&gt;     health_board_bar_info: function () </span></span>
<span><span class="co">#&gt;     health_board_choices: function () </span></span>
<span><span class="co">#&gt;     health_board_data: function (health_board, gender) </span></span>
<span><span class="co">#&gt;     health_board_trend: function (...) </span></span>
<span><span class="co">#&gt;     health_board_trend_data: function (health_board = private[["health_board_choices"]](), </span></span>
<span><span class="co">#&gt;     health_board_trend_info: function () </span></span>
<span><span class="co">#&gt;     id_name_labels: function (x, name) </span></span>
<span><span class="co">#&gt;     id_name_selection: function () </span></span>
<span><span class="co">#&gt;     map_combine: function (func, nms = self[["IDs"]](), id = "ID", ...) </span></span>
<span><span class="co">#&gt;     national_pyramid: function () </span></span>
<span><span class="co">#&gt;     national_pyramid_data: function () </span></span>
<span><span class="co">#&gt;     national_pyramid_info: function () </span></span>
<span><span class="co">#&gt;     national_trend: function (...) </span></span>
<span><span class="co">#&gt;     national_trend_data: function () </span></span>
<span><span class="co">#&gt;     national_trend_info: function () </span></span>
<span><span class="co">#&gt;     trend_data: function (x, ...) </span></span>
<span><span class="co">#&gt;     trend_echart: function (x) </span></span>
<span><span class="co">#&gt;     unit_choices: function ()</span></span></code></pre></div>
</div>
<p>This will return a <code><a href="../reference/gp_grp.html">gp_grp()</a></code> object. However, a single gp object can be pulled out using <code>$health_unit</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">health_unit</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"10017"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;gp&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unit&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     .metadata: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     address: function () </span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     health_board: function () </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.metadata, .data) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     popup_modal: function (ns) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     telephone: function () </span></span>
<span><span class="co">#&gt;     title: function () </span></span>
<span><span class="co">#&gt;     ui: function (ns) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     population_pyramid: function (...) </span></span>
<span><span class="co">#&gt;     population_pyramid_data: function () </span></span>
<span><span class="co">#&gt;     population_pyramid_info: function () </span></span>
<span><span class="co">#&gt;     population_trend: function (...) </span></span>
<span><span class="co">#&gt;     population_trend_data: function () </span></span>
<span><span class="co">#&gt;     population_trend_info: function () </span></span>
<span><span class="co">#&gt;     population_trend_y_range: function () </span></span>
<span><span class="co">#&gt;     required_data_cols: function () </span></span>
<span><span class="co">#&gt;     required_metadata_cols: function () </span></span>
<span><span class="co">#&gt;     title_col: function ()</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="plotting-2">Plotting<a class="anchor" aria-label="anchor" href="#plotting-2"></a>
</h4>
<p>Visualising data assciated with multiple GP practices can be achieved using the <code>$plot</code> function with an appropriate <code>type</code> argument. To see which plot types are available to use, the <code>$available_plots</code> function can be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">available_plots</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "national_trend"     "national_pyramid"   "health_board_trend"</span></span>
<span><span class="co">#&gt; [4] "health_board_bar"   "gp_trend"           "gp_bar"</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"gp_bar"</span><span class="op">)</span></span></code></pre></div>
<div id="fig-gp_grp_bar" class="cell-output-display quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-gp_grp_bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="echarts4r html-widget html-fill-item" id="htmlwidget-16848531887bbd224b5d" style="width:100%;height:500px;"></div>
<script type="application/json" data-for="htmlwidget-16848531887bbd224b5d">{"x":{"theme":"","tl":true,"draw":true,"renderer":"canvas","events":[],"buttons":[],"opts":{"baseOption":{"yAxis":[{"show":true,"name":"Population"}],"timeline":{"data":["20231001","20240101","20240401"],"axisType":"category","autoPlay":true,"top":0},"xAxis":[{"data":["Ages0to4","Ages5to14","Ages15to24","Ages25to44","Ages45to64","Ages65to74","Ages75to84","Ages85plus"],"type":"category","boundaryGap":true,"name":"Age"}],"tooltip":{"trigger":"axis"},"legend":{"show":false,"type":"plain","data":["10002 - Muirhead Medical Centre","10017 - The Blue Practice"]},"series":[{"name":"10002 - Muirhead Medical Centre","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d"},{"name":"10017 - The Blue Practice","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d"}]},"options":[{"series":[{"data":[{"value":["Ages0to4"," 186"]},{"value":["Ages5to14"," 463"]},{"value":["Ages15to24"," 419"]},{"value":["Ages25to44"," 952"]},{"value":["Ages45to64","1170"]},{"value":["Ages65to74"," 494"]},{"value":["Ages75to84"," 307"]},{"value":["Ages85plus","  94"]}]},{"data":[{"value":["Ages0to4","128"]},{"value":["Ages5to14","362"]},{"value":["Ages15to24","509"]},{"value":["Ages25to44","738"]},{"value":["Ages45to64","976"]},{"value":["Ages65to74","422"]},{"value":["Ages75to84","298"]},{"value":["Ages85plus","107"]}]}]},{"series":[{"data":[{"value":["Ages0to4"," 190"]},{"value":["Ages5to14"," 456"]},{"value":["Ages15to24"," 419"]},{"value":["Ages25to44"," 946"]},{"value":["Ages45to64","1159"]},{"value":["Ages65to74"," 496"]},{"value":["Ages75to84"," 308"]},{"value":["Ages85plus","  91"]}]},{"data":[{"value":["Ages0to4","126"]},{"value":["Ages5to14","385"]},{"value":["Ages15to24","505"]},{"value":["Ages25to44","765"]},{"value":["Ages45to64","982"]},{"value":["Ages65to74","420"]},{"value":["Ages75to84","307"]},{"value":["Ages85plus","106"]}]}]},{"series":[{"data":[{"value":["Ages0to4"," 186"]},{"value":["Ages5to14"," 456"]},{"value":["Ages15to24"," 415"]},{"value":["Ages25to44"," 945"]},{"value":["Ages45to64","1160"]},{"value":["Ages65to74"," 494"]},{"value":["Ages75to84"," 312"]},{"value":["Ages85plus","  88"]}]},{"data":[{"value":["Ages0to4","134"]},{"value":["Ages5to14","393"]},{"value":["Ages15to24","512"]},{"value":["Ages25to44","780"]},{"value":["Ages45to64","991"]},{"value":["Ages65to74","422"]},{"value":["Ages75to84","315"]},{"value":["Ages85plus","105"]}]}]}],"legend":{"data":[null,null,null,null,null,null]}},"dispose":true},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gp_grp_bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 3: This bar chart shows the total number of GP registered patients (y-axis) for each individal GP practice (colour) across age categories (x-axis). Settings can be used to show data for different GP practices and genders.
</figcaption></figure>
</div>
</div>
<p>Helper functions <code>$plot_data</code> and <code>$plot_info</code> can be used to create the data associated with each plot and character text describing each plot (alongside functionality related to the shiny application) respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">plot_data</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"gp_bar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 24 × 4</span></span>
<span><span class="co">#&gt; # Groups:   Date [3]</span></span>
<span><span class="co">#&gt;        Date Age        `10002 - Muirhead Medical Centre` 10017 - The Blue Prac…¹</span></span>
<span><span class="co">#&gt;       &lt;dbl&gt; &lt;fct&gt;                                  &lt;dbl&gt;                   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 20231001 Ages0to4                                 186                     128</span></span>
<span><span class="co">#&gt;  2 20231001 Ages5to14                                463                     362</span></span>
<span><span class="co">#&gt;  3 20231001 Ages15to24                               419                     509</span></span>
<span><span class="co">#&gt;  4 20231001 Ages25to44                               952                     738</span></span>
<span><span class="co">#&gt;  5 20231001 Ages45to64                              1170                     976</span></span>
<span><span class="co">#&gt;  6 20231001 Ages65to74                               494                     422</span></span>
<span><span class="co">#&gt;  7 20231001 Ages75to84                               307                     298</span></span>
<span><span class="co">#&gt;  8 20231001 Ages85plus                                94                     107</span></span>
<span><span class="co">#&gt;  9 20240101 Ages0to4                                 190                     126</span></span>
<span><span class="co">#&gt; 10 20240101 Ages5to14                                456                     385</span></span>
<span><span class="co">#&gt; # ℹ 14 more rows</span></span>
<span><span class="co">#&gt; # ℹ abbreviated name: ¹​`10017 - The Blue Practice`</span></span>
<span><span class="va">gp_grp_unit</span><span class="op">$</span><span class="fu">plot_info</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"gp_bar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "This bar chart shows the total number of GP registered patients\n        (y-axis) for each individal GP practice (colour) across\n        age categories (x-axis). Settings can be used to show data for\n        different GP practices and genders."</span></span></code></pre></div>
</div>
</section></section><section class="level2"><h3 id="hospital-1">Hospital<a class="anchor" aria-label="anchor" href="#hospital-1"></a>
</h3>
<p>Data associated with multiple hospitals is stored in <code><a href="../reference/hospital_grp.html">hospital_grp()</a></code> objects. <code><a href="../reference/example_hospital_grp_unit.html">example_hospital_grp_unit()</a></code> can be used to render an example object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_grp_unit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_hospital_grp_unit.html">example_hospital_grp_unit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">hospital_grp_unit</span></span>
<span><span class="co">#&gt; &lt;hospital_grp&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unitgrp&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: list</span></span>
<span><span class="co">#&gt;     .id: hospital</span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     download_handler: function () </span></span>
<span><span class="co">#&gt;     health_unit: function (id) </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     IDs: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.data, .id) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     subset: function (id) </span></span>
<span><span class="co">#&gt;     titles: function () </span></span>
<span><span class="co">#&gt;     ui: function (...) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     bar_data: function (x, ...) </span></span>
<span><span class="co">#&gt;     bar_echart: function (x, group = "HBName", x_axis = "", y_axis = "PercentageOccupancy") </span></span>
<span><span class="co">#&gt;     health_board_bar: function (...) </span></span>
<span><span class="co">#&gt;     health_board_bar_data: function (specialties = "All Specialties", health_boards = private[["health_board_choices"]]()) </span></span>
<span><span class="co">#&gt;     health_board_bar_info: function () </span></span>
<span><span class="co">#&gt;     health_board_choices: function () </span></span>
<span><span class="co">#&gt;     health_board_data: function (specialties, health_boards) </span></span>
<span><span class="co">#&gt;     health_board_trend: function (...) </span></span>
<span><span class="co">#&gt;     health_board_trend_data: function (specialties = "All Specialties", health_boards = private[["health_board_choices"]]()) </span></span>
<span><span class="co">#&gt;     health_board_trend_info: function () </span></span>
<span><span class="co">#&gt;     hospital_bar: function (...) </span></span>
<span><span class="co">#&gt;     hospital_bar_data: function (specialties = private[["specialty_choices"]](), hospitals = private[["unit_choices"]]()) </span></span>
<span><span class="co">#&gt;     hospital_bar_info: function () </span></span>
<span><span class="co">#&gt;     hospital_data: function (specialties, hospitals) </span></span>
<span><span class="co">#&gt;     hospital_trend: function (...) </span></span>
<span><span class="co">#&gt;     hospital_trend_data: function (specialties = "All Specialties", hospitals = private[["unit_choices"]]()) </span></span>
<span><span class="co">#&gt;     hospital_trend_info: function () </span></span>
<span><span class="co">#&gt;     id_name_labels: function (x, name) </span></span>
<span><span class="co">#&gt;     id_name_selection: function () </span></span>
<span><span class="co">#&gt;     map_combine: function (func, nms = self[["IDs"]](), id = "ID", ...) </span></span>
<span><span class="co">#&gt;     national_trend: function (...) </span></span>
<span><span class="co">#&gt;     national_trend_data: function (specialties = "All Specialties") </span></span>
<span><span class="co">#&gt;     national_trend_info: function () </span></span>
<span><span class="co">#&gt;     req_plot_cols: function () </span></span>
<span><span class="co">#&gt;     specialty_choices: function () </span></span>
<span><span class="co">#&gt;     summarise_percentage_occupancy: function (x, groups = colnames(x)) </span></span>
<span><span class="co">#&gt;     trend_data: function (x, ...) </span></span>
<span><span class="co">#&gt;     trend_echart: function (x) </span></span>
<span><span class="co">#&gt;     unit_choices: function ()</span></span></code></pre></div>
</div>
<section class="level3"><h4 id="data-3">Data<a class="anchor" aria-label="anchor" href="#data-3"></a>
</h4>
<p><code><a href="../reference/hospital_grp.html">hospital_grp()</a></code> objects contain a list of <code><a href="../reference/hospital.html">hospital()</a></code> health units. These can be accessed using the <code>$data</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; &lt;hospital&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unit&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     .metadata: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     address: function () </span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     health_board: function () </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.metadata, .data) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     popup_modal: function (ns) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     title: function () </span></span>
<span><span class="co">#&gt;     ui: function (ns) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     annual_cols: function () </span></span>
<span><span class="co">#&gt;     daily_cols: function () </span></span>
<span><span class="co">#&gt;     required_data_cols: function () </span></span>
<span><span class="co">#&gt;     required_metadata_cols: function () </span></span>
<span><span class="co">#&gt;     specialty_choices: function () </span></span>
<span><span class="co">#&gt;     specialty_line: function (...) </span></span>
<span><span class="co">#&gt;     specialty_line_data: function (data_type = c("annual", "daily"), specialties = "All Specialties") </span></span>
<span><span class="co">#&gt;     specialty_line_info: function (data_type = c("annual", "daily")) </span></span>
<span><span class="co">#&gt;     title_col: function () </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; &lt;hospital&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unit&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     .metadata: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     address: function () </span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     health_board: function () </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.metadata, .data) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     popup_modal: function (ns) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     title: function () </span></span>
<span><span class="co">#&gt;     ui: function (ns) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     annual_cols: function () </span></span>
<span><span class="co">#&gt;     daily_cols: function () </span></span>
<span><span class="co">#&gt;     required_data_cols: function () </span></span>
<span><span class="co">#&gt;     required_metadata_cols: function () </span></span>
<span><span class="co">#&gt;     specialty_choices: function () </span></span>
<span><span class="co">#&gt;     specialty_line: function (...) </span></span>
<span><span class="co">#&gt;     specialty_line_data: function (data_type = c("annual", "daily"), specialties = "All Specialties") </span></span>
<span><span class="co">#&gt;     specialty_line_info: function (data_type = c("annual", "daily")) </span></span>
<span><span class="co">#&gt;     title_col: function ()</span></span></code></pre></div>
</div>
<p>Metadata for all <code><a href="../reference/hospital.html">hospital()</a></code> health units within the hospital_grp object can be summarised using the <code>$metadata</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">metadata</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 16</span></span>
<span><span class="co">#&gt;   datasetID          ID    HospitalName AddressLine1 AddressLine2 AddressLine2QF</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;         </span></span>
<span><span class="co">#&gt; 1 c698f450-eeed-41a… A101H Arran War M… Lamlash      Isle of Arr… &lt;NA&gt;          </span></span>
<span><span class="co">#&gt; 2 c698f450-eeed-41a… A201H Ailsa Hospi… Dalmellingt… Ayr          &lt;NA&gt;          </span></span>
<span><span class="co">#&gt; # ℹ 10 more variables: AddressLine3 &lt;chr&gt;, AddressLine3QF &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   AddressLine4 &lt;chr&gt;, AddressLine4QF &lt;chr&gt;, Postcode &lt;chr&gt;, HBName &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   HSCP &lt;chr&gt;, CouncilArea &lt;chr&gt;, IntermediateZone &lt;chr&gt;, DataZone &lt;chr&gt;</span></span></code></pre></div>
</div>
<p>Additionally, selected metadata from the <code><a href="../reference/hospital.html">hospital()</a></code> health units can also be obtained using relevant getter functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">IDs</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A101H" "A201H"</span></span>
<span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">titles</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Arran War Memorial Hospital" "Ailsa Hospital"</span></span></code></pre></div>
</div>
<p><code><a href="../reference/hospital_grp.html">hospital_grp()</a></code> objects can also be subset to the selected hospitals using <code>$subset</code> with a set of character IDs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">subset</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"A201H"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;hospital_grp&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unitgrp&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: list</span></span>
<span><span class="co">#&gt;     .id: hospital</span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     download_handler: function () </span></span>
<span><span class="co">#&gt;     health_unit: function (id) </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     IDs: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.data, .id) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     subset: function (id) </span></span>
<span><span class="co">#&gt;     titles: function () </span></span>
<span><span class="co">#&gt;     ui: function (...) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     bar_data: function (x, ...) </span></span>
<span><span class="co">#&gt;     bar_echart: function (x, group = "HBName", x_axis = "", y_axis = "PercentageOccupancy") </span></span>
<span><span class="co">#&gt;     health_board_bar: function (...) </span></span>
<span><span class="co">#&gt;     health_board_bar_data: function (specialties = "All Specialties", health_boards = private[["health_board_choices"]]()) </span></span>
<span><span class="co">#&gt;     health_board_bar_info: function () </span></span>
<span><span class="co">#&gt;     health_board_choices: function () </span></span>
<span><span class="co">#&gt;     health_board_data: function (specialties, health_boards) </span></span>
<span><span class="co">#&gt;     health_board_trend: function (...) </span></span>
<span><span class="co">#&gt;     health_board_trend_data: function (specialties = "All Specialties", health_boards = private[["health_board_choices"]]()) </span></span>
<span><span class="co">#&gt;     health_board_trend_info: function () </span></span>
<span><span class="co">#&gt;     hospital_bar: function (...) </span></span>
<span><span class="co">#&gt;     hospital_bar_data: function (specialties = private[["specialty_choices"]](), hospitals = private[["unit_choices"]]()) </span></span>
<span><span class="co">#&gt;     hospital_bar_info: function () </span></span>
<span><span class="co">#&gt;     hospital_data: function (specialties, hospitals) </span></span>
<span><span class="co">#&gt;     hospital_trend: function (...) </span></span>
<span><span class="co">#&gt;     hospital_trend_data: function (specialties = "All Specialties", hospitals = private[["unit_choices"]]()) </span></span>
<span><span class="co">#&gt;     hospital_trend_info: function () </span></span>
<span><span class="co">#&gt;     id_name_labels: function (x, name) </span></span>
<span><span class="co">#&gt;     id_name_selection: function () </span></span>
<span><span class="co">#&gt;     map_combine: function (func, nms = self[["IDs"]](), id = "ID", ...) </span></span>
<span><span class="co">#&gt;     national_trend: function (...) </span></span>
<span><span class="co">#&gt;     national_trend_data: function (specialties = "All Specialties") </span></span>
<span><span class="co">#&gt;     national_trend_info: function () </span></span>
<span><span class="co">#&gt;     req_plot_cols: function () </span></span>
<span><span class="co">#&gt;     specialty_choices: function () </span></span>
<span><span class="co">#&gt;     summarise_percentage_occupancy: function (x, groups = colnames(x)) </span></span>
<span><span class="co">#&gt;     trend_data: function (x, ...) </span></span>
<span><span class="co">#&gt;     trend_echart: function (x) </span></span>
<span><span class="co">#&gt;     unit_choices: function ()</span></span></code></pre></div>
</div>
<p>This will return a <code><a href="../reference/hospital_grp.html">hospital_grp()</a></code> object. However, a single hospital object can be pulled out using <code>$health_unit</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">health_unit</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"A201H"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;hospital&gt;</span></span>
<span><span class="co">#&gt;   Inherits from: &lt;health_unit&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     .data: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     .metadata: tbl_df, tbl, data.frame</span></span>
<span><span class="co">#&gt;     address: function () </span></span>
<span><span class="co">#&gt;     available_plots: function () </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     combine_data: function () </span></span>
<span><span class="co">#&gt;     data: function () </span></span>
<span><span class="co">#&gt;     health_board: function () </span></span>
<span><span class="co">#&gt;     ID: function () </span></span>
<span><span class="co">#&gt;     initialize: function (.metadata, .data) </span></span>
<span><span class="co">#&gt;     metadata: function () </span></span>
<span><span class="co">#&gt;     plot: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_data: function (type, ...) </span></span>
<span><span class="co">#&gt;     plot_info: function (type, ...) </span></span>
<span><span class="co">#&gt;     popup_modal: function (ns) </span></span>
<span><span class="co">#&gt;     server: function () </span></span>
<span><span class="co">#&gt;     title: function () </span></span>
<span><span class="co">#&gt;     ui: function (ns) </span></span>
<span><span class="co">#&gt;     validate: function () </span></span>
<span><span class="co">#&gt;   Private:</span></span>
<span><span class="co">#&gt;     annual_cols: function () </span></span>
<span><span class="co">#&gt;     daily_cols: function () </span></span>
<span><span class="co">#&gt;     required_data_cols: function () </span></span>
<span><span class="co">#&gt;     required_metadata_cols: function () </span></span>
<span><span class="co">#&gt;     specialty_choices: function () </span></span>
<span><span class="co">#&gt;     specialty_line: function (...) </span></span>
<span><span class="co">#&gt;     specialty_line_data: function (data_type = c("annual", "daily"), specialties = "All Specialties") </span></span>
<span><span class="co">#&gt;     specialty_line_info: function (data_type = c("annual", "daily")) </span></span>
<span><span class="co">#&gt;     title_col: function ()</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="plotting-3">Plotting<a class="anchor" aria-label="anchor" href="#plotting-3"></a>
</h4>
<p>Visualising data assciated with multiple hospitals can be achieved using the <code>$plot</code> function with an appropriate <code>type</code> argument. To see which plot types are available to use, the <code>$available_plots</code> function can be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">available_plots</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "national_trend"     "health_board_trend" "health_board_bar"  </span></span>
<span><span class="co">#&gt; [4] "hospital_trend"     "hospital_bar"</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"hospital_bar"</span><span class="op">)</span></span></code></pre></div>
<div id="fig-hospital_grp_bar" class="cell-output-display quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-hospital_grp_bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="echarts4r html-widget html-fill-item" id="htmlwidget-c811f9cddeb3c228d1ca" style="width:100%;height:500px;"></div>
<script type="application/json" data-for="htmlwidget-c811f9cddeb3c228d1ca">{"x":{"theme":"","tl":true,"draw":true,"renderer":"canvas","events":[],"buttons":[],"opts":{"baseOption":{"yAxis":[{"show":true,"name":"PercentageOccupancy","min":0,"max":100}],"timeline":{"data":["2022/23","2023/24"],"axisType":"category","autoPlay":true,"top":0},"xAxis":[{"data":["A101H - Arran War Memorial Hospital","A201H - Ailsa Hospital"],"type":"category","boundaryGap":true,"name":"Hospital"}],"tooltip":{"trigger":"axis"},"legend":{"show":false,"type":"plain","data":["FinancialYear","HBName","All Specialties","Community Grouping","GP Other than Obstetrics","Mental Health Grouping","Psychiatry of Old Age"]},"series":[{"name":"FinancialYear","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d"},{"name":"HBName","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d"},{"name":"All Specialties","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d"},{"name":"Community Grouping","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d"},{"name":"GP Other than Obstetrics","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d"},{"name":"Mental Health Grouping","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d"},{"name":"Psychiatry of Old Age","type":"bar","yAxisIndex":0,"xAxisIndex":0,"coordinateSystem":"cartesian2d"}]},"options":[{"series":[{"data":[{"value":["A101H - Arran War Memorial Hospital","2022/23"]},{"value":["A201H - Ailsa Hospital","2022/23"]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital","S08000015"]},{"value":["A201H - Ailsa Hospital","S08000015"]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital","77.4"]},{"value":["A201H - Ailsa Hospital","77.9"]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital","77.4"]},{"value":["A201H - Ailsa Hospital",null]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital","77.4"]},{"value":["A201H - Ailsa Hospital",null]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital",null]},{"value":["A201H - Ailsa Hospital","77.9"]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital",null]},{"value":["A201H - Ailsa Hospital","77.9"]}]}]},{"series":[{"data":[{"value":["A101H - Arran War Memorial Hospital","2023/24"]},{"value":["A201H - Ailsa Hospital","2023/24"]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital","S08000015"]},{"value":["A201H - Ailsa Hospital","S08000015"]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital","68.5"]},{"value":["A201H - Ailsa Hospital","72.6"]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital","68.5"]},{"value":["A201H - Ailsa Hospital",null]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital","68.5"]},{"value":["A201H - Ailsa Hospital",null]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital",null]},{"value":["A201H - Ailsa Hospital","72.6"]}]},{"data":[{"value":["A101H - Arran War Memorial Hospital",null]},{"value":["A201H - Ailsa Hospital","72.6"]}]}]}],"legend":{"data":[null,null,null,null,null,null,null,null,null,null,null,null,null,null]}},"dispose":true},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hospital_grp_bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 4: This bar chart shows the average hospital bed occupancy (y-axis) per hospital (x-axis) for each specialty (colour). Seetings can be used to show data for different specialties (default is all specialties) and hospitals.
</figcaption></figure>
</div>
</div>
<p>Helper functions <code>$plot_data</code> and <code>$plot_info</code> can be used to create the data associated with each plot and character text describing each plot (alongside functionality related to the shiny application) respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">plot_data</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"hospital_bar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 8</span></span>
<span><span class="co">#&gt; # Groups:   FinancialYear [2]</span></span>
<span><span class="co">#&gt;   FinancialYear ID                 HBName `All Specialties` `Community Grouping`</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;              &lt;chr&gt;              &lt;dbl&gt;                &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2022/23       A101H - Arran War… S0800…              77.4                 77.4</span></span>
<span><span class="co">#&gt; 2 2022/23       A201H - Ailsa Hos… S0800…              77.9                 NA  </span></span>
<span><span class="co">#&gt; 3 2023/24       A101H - Arran War… S0800…              68.5                 68.5</span></span>
<span><span class="co">#&gt; 4 2023/24       A201H - Ailsa Hos… S0800…              72.6                 NA  </span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: `GP Other than Obstetrics` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Mental Health Grouping` &lt;dbl&gt;, `Psychiatry of Old Age` &lt;dbl&gt;</span></span>
<span><span class="va">hospital_grp_unit</span><span class="op">$</span><span class="fu">plot_info</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"hospital_bar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "This bar chart shows the average hospital bed occupancy (y-axis)\n        per hospital (x-axis) for each specialty (colour). Seetings can be\n        used to show data for different specialties (default is all\n        specialties) and hospitals."</span></span></code></pre></div>
</div>
</section></section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jack Sleight.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
